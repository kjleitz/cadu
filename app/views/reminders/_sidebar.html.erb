<h3 id="reminders-header" class="text-center">Reminders</h3>

<div class="reminders-nav-area">
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a href="" class="nav-link active" id="new-reminders-tab-link"><%= current_user.client? ? "New" : "Sent" %></a>
    </li>
    <li class="nav-item">
      <a href="" class="nav-link text-muted" id="dismissed-reminders-tab-link">Dismissed<%= " by client" if current_user.assistant? %></a>
    </li>
  </ul>
</div>

<div class="reminder-card-list" id="new-reminder-card-list">
  <% if current_user.assistant? %>
  <span class="reminder-link-list-title">Send a reminder to:</span>
    <ul class="reminder-link-list">
      <% current_user.clients.each do |client| %>
        <li><%= link_to client.name, new_user_reminder_path(client) %></li>
      <% end %>
    </ul>
  <% end %>
  <% reminders.not_dismissed.each do |reminder| %>
  <article class="card reminder-card <%= reminder.status %>">
    <ul class="list-group list-group-flush">
      <li class="list-group-item reminder-content"><%= reminder.content %></li>
      <%= content_tag(:li, raw("Sent to&nbsp;#{link_to reminder.client.name, user_path(reminder.client)}"), class: "list-group-item reminder-client") if current_user.assistant? %>
      <li class="list-group-item reminder-created-at"><%= reminder.human_created_at %></li>
      <%= link_to content_tag(:li, "Concerning '#{reminder.task.title}' #{'(' + reminder.task.status.humanize.downcase + ')' unless reminder.task.status == "idle"}", class: "list-group-item reminder-task task-#{reminder.task.status}"), task_path(reminder.task), class: "concerning-link" if reminder.task %>
    </ul>
    <div class="card-footer">
      <%= button_to "Dismiss", dismiss_reminder_path(reminder), class: "btn btn-danger float-right" %>
    </div>
  </article>
  <% end %>
</div>

<div class="reminder-card-list hidden-xs-up" id="dismissed-reminder-card-list">
  <% reminders.dismissed.each do |reminder| %>
  <article class="card reminder-card <%= reminder.status %>">
    <ul class="list-group list-group-flush">
      <li class="list-group-item reminder-content"><em><%= reminder.content %></em></li>
      <%= content_tag(:li, raw("Sent to&nbsp;#{link_to reminder.client.name, user_path(reminder.client)}"), class: "list-group-item reminder-client") if current_user.assistant? %>
      <li class="list-group-item reminder-created-at"><%= reminder.human_created_at %></li>
      <%= link_to content_tag(:li, "Concerning '#{reminder.task.title}'", class: "list-group-item reminder-task task-#{reminder.task.status}"), task_path(reminder.task), class: "concerning-link" if reminder.task %>
    </ul>
  </article>
  <% end %>
</div>
